syntax = "proto3";

package domain;

import "github.com/gogo/protobuf/gogoproto/gogo.proto";

import "google/protobuf/timestamp.proto";

message Package {
  uint64 id = 1 [(gogoproto.customname) = "ID"];
  string name = 2;
  string path = 3;
  string url = 4 [(gogoproto.customname) = "URL"];
  string owner = 5;
  string vcs = 6 [(gogoproto.customname) = "VCS"];
  PackageSnapshot data = 7;
  google.protobuf.Timestamp first_seen_at = 8 [(gogoproto.stdtime) = true];
  repeated PackageCrawl history = 9;
  // int history_last_change_index = 10;
}

message PackageCrawl {
  google.protobuf.Timestamp job_started_at = 1 [(gogoproto.stdtime) = true];
  google.protobuf.Timestamp job_finished_at = 2 [(gogoproto.stdtime) = true];
  string job_reason = 3;
  bool job_succeeded = 4;
  repeated string job_messages = 5;
  PackageSnapshot data = 6;
}

message PackageSnapshot {
  google.protobuf.Timestamp created_at = 1 [(gogoproto.stdtime) = true];
  repeated string imports = 2;
  repeated string test_imports = 3;
  int32 commits = 4;
  int32 branches = 5;
  int32 tags = 6;
  int64 bytes = 7;
  int32 forks = 8;
  int32 stars = 9;
}
